<section>
  <h1 class="h3 mb-3 text-gray-800 mt-3">Status</h1>
</section>
<section>
  <div class="row">
    <div class="col-lg-9">

      <% if @stats.present? %>
        <h3>
          Services statistics
        </h3>

        <p>Statistics are collected periodically, the following statistics correspond to the current value.</p>

        <div class="table-responsive">
          <table class="table table-sm table-bordered">
            <thead class="thead-dark">
              <tr>
                <th scope="col">Service</th>
                <th scope="col">CPU (1m = 1/1000 of a CPU usage)</th>
                <th scope="col">Memory</th>
              </tr>
            </thead>
            <tbody>              
            <% @stats.each do |s| %>
              <tr>
                <td><%= s["service"] %></td>
                <td><%= s['cpu_raw'] %></td>
                <td><%= s['memory_raw'] %></td>
              </tr>
            <% end %>     
            </tbody>
          </table>           
        </div>

        <hr />
      <% end %>

      <% if @top_result.present? %>
        <h3>
          Processes Usage (Live):
        </h3>
        <textarea class="dynamic-terminal rounded mb-2">
  <%= @top_result %>
        </textarea>
        <hr />
      <% end %>

      <h3>
        Containers statuses (updated hourly)
      </h3>

      <% if @website_summary.dig('status') == 'online' &&
          @website_summary.dig('out_of_memory_detected') %>
        <p class="text-danger">** Out of memory detected **</p>
      <% end %>

      <textarea class="dynamic-terminal rounded mb-2">
<%= JSON.pretty_generate @status %>
      </textarea>
      <hr />

    </div>
    <div class="col-lg-3">
      <%= render 'admin/instances/access/sidebar', instance_id: params[:id] %>
    </div> 
  </div>
</section>
